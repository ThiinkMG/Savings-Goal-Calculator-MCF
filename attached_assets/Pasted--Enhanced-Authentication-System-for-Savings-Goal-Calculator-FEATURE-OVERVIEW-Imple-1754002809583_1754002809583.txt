## **Enhanced Authentication System for Savings Goal Calculator**

### **FEATURE OVERVIEW**
Implement a comprehensive authentication system with multiple login methods and secure password recovery options.

---

### **1. MULTI-METHOD LOGIN SYSTEM**

#### **Login Options Available:**
- **Email address** (primary)
- **Phone number** (with country code)
- **Username** (user-created handle)

#### **Updated Login Form:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sign In to Your Account     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Email, Phone, or Username   â”‚
â”‚ [________________]          â”‚
â”‚                             â”‚
â”‚ Password                    â”‚
â”‚ [________________] [ğŸ‘]     â”‚
â”‚                             â”‚
â”‚ [ ] Remember me             â”‚
â”‚                             â”‚
â”‚ [     Sign In     ]         â”‚
â”‚                             â”‚
â”‚ Forgot Password/Username?   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Input Validation Logic:**
- **Auto-detect input type** based on format:
  - Contains @ = Email
  - Starts with + or numbers = Phone
  - Otherwise = Username
- **Real-time validation** with visual feedback
- **Format helpers** (phone number formatting)

---

### **2. ACCOUNT CREATION UPDATES**

#### **Enhanced Registration Form:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Your Account         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Full Name                   â”‚
â”‚ [________________]          â”‚
â”‚                             â”‚
â”‚ Email Address *             â”‚
â”‚ [________________]          â”‚
â”‚                             â”‚
â”‚ Phone Number (Optional)     â”‚
â”‚ [+1] [_______________]      â”‚
â”‚                             â”‚
â”‚ Username *                  â”‚
â”‚ [________________]          â”‚
â”‚ Available âœ“ / Taken âœ—       â”‚
â”‚                             â”‚
â”‚ Password *                  â”‚
â”‚ [________________] [ğŸ‘]     â”‚
â”‚ Strength: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] Strong   â”‚
â”‚                             â”‚
â”‚ Confirm Password *          â”‚
â”‚ [________________] [ğŸ‘]     â”‚
â”‚                             â”‚
â”‚ [    Create Account    ]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Registration Requirements:**
- **Email** (required) - primary recovery method
- **Username** (required) - unique identifier
- **Phone** (optional) - secondary recovery method
- **Password strength validation**
- **Real-time username availability check**

---

### **3. FORGOT PASSWORD/USERNAME SYSTEM**

#### **Recovery Entry Point:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Account Recovery            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ What do you need help with? â”‚
â”‚                             â”‚
â”‚ â—‹ I forgot my password      â”‚
â”‚ â—‹ I forgot my username      â”‚
â”‚ â—‹ I forgot both             â”‚
â”‚                             â”‚
â”‚ [      Continue      ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Recovery Methods Available:**
- **Email verification** (if email provided)
- **SMS verification** (if phone provided)
- **Security questions** (backup method)

---

### **4. PASSWORD RECOVERY FLOW**

#### **Step 1 - Account Identification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reset Your Password         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Enter your email or phone   â”‚
â”‚ number to receive a reset   â”‚
â”‚ code                        â”‚
â”‚                             â”‚
â”‚ Email or Phone              â”‚
â”‚ [________________]          â”‚
â”‚                             â”‚
â”‚ [   Send Reset Code   ]     â”‚
â”‚                             â”‚
â”‚ Don't have access to these? â”‚
â”‚ Try security questions      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Step 2 - Verification Method Selection:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Choose Verification Method  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ How would you like to       â”‚
â”‚ receive your reset code?    â”‚
â”‚                             â”‚
â”‚ â—‹ Email: j***@email.com     â”‚
â”‚ â—‹ Text: +1 (***) ***-1234   â”‚
â”‚                             â”‚
â”‚ [     Send Code     ]       â”‚
â”‚                             â”‚
â”‚ Code expires in 15 minutes  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Step 3 - Code Entry:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Enter Verification Code     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ We sent a 6-digit code to   â”‚
â”‚ your selected method        â”‚
â”‚                             â”‚
â”‚ [_] [_] [_] [_] [_] [_]     â”‚
â”‚                             â”‚
â”‚ [     Verify Code     ]     â”‚
â”‚                             â”‚
â”‚ Didn't receive it?          â”‚
â”‚ Resend code (0:45)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Step 4 - Password Reset:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create New Password         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ New Password                â”‚
â”‚ [________________] [ğŸ‘]     â”‚
â”‚ Strength: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] Strong   â”‚
â”‚                             â”‚
â”‚ Confirm New Password        â”‚
â”‚ [________________] [ğŸ‘]     â”‚
â”‚                             â”‚
â”‚ [   Update Password   ]     â”‚
â”‚                             â”‚
â”‚ Password Requirements:      â”‚
â”‚ â€¢ 8+ characters            â”‚
â”‚ â€¢ Mix of letters & numbers â”‚
â”‚ â€¢ At least 1 special char  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **5. USERNAME RECOVERY FLOW**

#### **Username Recovery Process:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recover Your Username       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Enter the email or phone    â”‚
â”‚ associated with your accountâ”‚
â”‚                             â”‚
â”‚ Email or Phone              â”‚
â”‚ [________________]          â”‚
â”‚                             â”‚
â”‚ [   Send Username   ]       â”‚
â”‚                             â”‚
â”‚ We'll send your username    â”‚
â”‚ to this contact method      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Username Delivery:**
- **Email:** "Your username is: [username]"
- **SMS:** "Your Savings Calculator username: [username]"

---

### **6. TECHNICAL IMPLEMENTATION REQUIREMENTS**

#### **Database Schema Updates:**
```sql
-- Update users table
ALTER TABLE users ADD COLUMN phone_number VARCHAR(20);
ALTER TABLE users ADD COLUMN phone_verified BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN username VARCHAR(50) UNIQUE;

-- Create verification codes table
CREATE TABLE verification_codes (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    code VARCHAR(6),
    type VARCHAR(20), -- 'password_reset', 'username_recovery'
    method VARCHAR(10), -- 'email', 'sms'
    expires_at TIMESTAMP,
    used BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### **API Endpoints Needed:**
```
POST /api/auth/login
- Accept email, phone, or username
- Validate credentials
- Return JWT token

POST /api/auth/register
- Validate unique username/email
- Create account with multiple identifiers

POST /api/auth/forgot-password
- Generate verification code
- Send via email or SMS

POST /api/auth/verify-reset-code
- Validate 6-digit code
- Return temporary reset token

POST /api/auth/reset-password
- Update password with reset token

POST /api/auth/forgot-username
- Send username via email/SMS

GET /api/auth/check-username
- Real-time username availability
```

#### **Security Features:**
- **Rate limiting** - Max 3 attempts per 15 minutes
- **Code expiration** - 15-minute timeout
- **One-time use codes** - Cannot reuse verification codes
- **Account lockout** - After 5 failed attempts
- **Input sanitization** - Prevent injection attacks

#### **External Services Integration:**
- **Email service** (SendGrid, AWS SES, or Resend)
- **SMS service** (Twilio, AWS SNS)
- **Phone number validation** library

---

### **7. USER EXPERIENCE ENHANCEMENTS**

#### **Smart Input Detection:**
- **Auto-format** phone numbers as user types
- **Validate email** format in real-time
- **Username suggestions** if taken
- **Password strength meter** with recommendations

#### **Progressive Disclosure:**
- **Show recovery options** based on available contact methods
- **Contextual help** for each step
- **Clear error messages** with suggested fixes
- **Success confirmations** at each stage

#### **Accessibility Features:**
- **Screen reader support** for all forms
- **Keyboard navigation** throughout flows
- **High contrast mode** compatibility
- **Clear focus indicators**

---

### **8. REPLIT IMPLEMENTATION CHECKLIST**

**Phase 1 - Database & API:**
- [ ] Update user schema with phone/username fields
- [ ] Create verification codes table
- [ ] Build authentication API endpoints
- [ ] Integrate email/SMS services

**Phase 2 - Frontend Updates:**
- [ ] Update login form with multi-method input
- [ ] Enhance registration form
- [ ] Build forgot password flow
- [ ] Create username recovery flow

**Phase 3 - Security & Validation:**
- [ ] Implement rate limiting
- [ ] Add input validation
- [ ] Set up code expiration
- [ ] Add account lockout protection

**Phase 4 - Testing & Polish:**
- [ ] Test all recovery flows
- [ ] Validate security measures
- [ ] Check mobile responsiveness
- [ ] Verify accessibility compliance

This comprehensive system provides users with flexible login options and secure recovery methods while maintaining strong security standards.