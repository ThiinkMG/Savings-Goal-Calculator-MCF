## **Update Password/Username Settings Section**

### **SECTION OVERVIEW**
Add a secure password and username update system within the settings panel that requires current password verification for any changes.

---

### **1. SETTINGS PANEL INTEGRATION**

#### **Add to Account Settings Section:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ‘¤ Account Settings         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Profile Information         â”‚
â”‚ Name: TeamThink             â”‚
â”‚ Email: team@email.com       â”‚
â”‚ Phone: +1 234-567-8900      â”‚
â”‚ [Edit Profile]              â”‚
â”‚                             â”‚
â”‚ Security & Access           â”‚ â† NEW SECTION
â”‚ [Change Password]           â”‚ â† NEW
â”‚ [Update Username]           â”‚ â† NEW
â”‚                             â”‚
â”‚ Login Methods               â”‚
â”‚ âœ“ Email âœ“ Username âœ“ Phone â”‚
â”‚                             â”‚
â”‚ Two-Factor Authentication   â”‚
â”‚ [Setup 2FA]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **2. CHANGE PASSWORD FLOW**

#### **Step 1 - Initial Click:**
User clicks **[Change Password]** button in settings

#### **Step 2 - Challenge Modal Appears:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Change Password              [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ðŸ”’ Verify Your Identity             â”‚
â”‚                                     â”‚
â”‚ Enter your current password to      â”‚
â”‚ make changes to your account        â”‚
â”‚                                     â”‚
â”‚ Current Password                    â”‚
â”‚ [____________________] [ðŸ‘]         â”‚
â”‚                                     â”‚
â”‚ [      Verify & Continue      ]     â”‚
â”‚                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Need Help? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                     â”‚
â”‚ Forgot your password?               â”‚
â”‚ [Reset Password Instead]            â”‚
â”‚                                     â”‚
â”‚ Can't remember your username?       â”‚
â”‚ [Recover Username]                  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Step 3 - After Successful Verification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create New Password          [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ âœ… Identity Verified                â”‚
â”‚                                     â”‚
â”‚ New Password                        â”‚
â”‚ [____________________] [ðŸ‘]         â”‚
â”‚ Strength: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] Strong           â”‚
â”‚                                     â”‚
â”‚ Confirm New Password                â”‚
â”‚ [____________________] [ðŸ‘]         â”‚
â”‚                                     â”‚
â”‚ Password Requirements:              â”‚
â”‚ âœ“ At least 8 characters            â”‚
â”‚ âœ“ Mix of letters and numbers       â”‚
â”‚ âœ“ At least 1 special character     â”‚
â”‚                                     â”‚
â”‚ [    Update Password    ]           â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **3. UPDATE USERNAME FLOW**

#### **Step 1 - Initial Click:**
User clicks **[Update Username]** button in settings

#### **Step 2 - Challenge Modal:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Username              [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ðŸ”’ Verify Your Identity             â”‚
â”‚                                     â”‚
â”‚ Enter your current password to      â”‚
â”‚ change your username                â”‚
â”‚                                     â”‚
â”‚ Current Username: TeamThink         â”‚
â”‚                                     â”‚
â”‚ Current Password                    â”‚
â”‚ [____________________] [ðŸ‘]         â”‚
â”‚                                     â”‚
â”‚ [      Verify & Continue      ]     â”‚
â”‚                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Need Help? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                     â”‚
â”‚ Forgot your password?               â”‚
â”‚ [Reset Password Instead]            â”‚
â”‚                                     â”‚
â”‚ Can't remember your username?       â”‚
â”‚ [Recover Username]                  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Step 3 - After Successful Verification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Choose New Username          [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ âœ… Identity Verified                â”‚
â”‚                                     â”‚
â”‚ Current Username: TeamThink         â”‚
â”‚                                     â”‚
â”‚ New Username                        â”‚
â”‚ [____________________]              â”‚
â”‚ âœ… Available / âŒ Taken             â”‚
â”‚                                     â”‚
â”‚ Username Requirements:              â”‚
â”‚ â€¢ 3-20 characters                   â”‚
â”‚ â€¢ Letters, numbers, underscore only â”‚
â”‚ â€¢ Must start with letter           â”‚
â”‚ â€¢ Cannot be changed for 30 days     â”‚
â”‚                                     â”‚
â”‚ [     Update Username     ]         â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **4. HELP LINK ACTIONS**

#### **"Reset Password Instead" Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reset Password               [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ðŸ“§ Password Reset                   â”‚
â”‚                                     â”‚
â”‚ We'll send a reset link to your     â”‚
â”‚ registered email address            â”‚
â”‚                                     â”‚
â”‚ Email: t***@email.com               â”‚
â”‚                                     â”‚
â”‚ [    Send Reset Link    ]           â”‚
â”‚                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚                                     â”‚
â”‚ Or choose a different method:       â”‚
â”‚                                     â”‚
â”‚ [ðŸ“± Send to Phone] [â“ Security Qs] â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **"Recover Username" Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recover Username             [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ðŸ“§ Username Recovery                â”‚
â”‚                                     â”‚
â”‚ We'll send your username to your    â”‚
â”‚ registered contact methods          â”‚
â”‚                                     â”‚
â”‚ Send to:                            â”‚
â”‚ â˜‘ï¸ Email: t***@email.com            â”‚
â”‚ â˜‘ï¸ Phone: +1 ***-***-8900           â”‚
â”‚                                     â”‚
â”‚ [   Send Username Info   ]          â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **5. SUCCESS/ERROR STATES**

#### **Success Messages:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Password Updated Successfully    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Your password has been changed.     â”‚
â”‚ You'll remain logged in on this     â”‚
â”‚ device, but will need to sign in    â”‚
â”‚ again on other devices.             â”‚
â”‚                                     â”‚
â”‚ [        Got It        ]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Username Updated Successfully    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Your username is now: NewUsername   â”‚
â”‚                                     â”‚
â”‚ Note: You can't change your         â”‚
â”‚ username again for 30 days.         â”‚
â”‚                                     â”‚
â”‚ [        Got It        ]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Error Messages:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ Incorrect Password               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ The password you entered is         â”‚
â”‚ incorrect. Please try again.        â”‚
â”‚                                     â”‚
â”‚ Attempts remaining: 2 of 3          â”‚
â”‚                                     â”‚
â”‚ [       Try Again       ]           â”‚
â”‚                                     â”‚
â”‚ [   Reset Password Instead   ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **6. TECHNICAL IMPLEMENTATION**

#### **Database Schema Updates:**
```sql
-- Track password change attempts
CREATE TABLE password_change_attempts (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    ip_address INET,
    successful BOOLEAN,
    attempted_at TIMESTAMP DEFAULT NOW()
);

-- Track username changes (rate limiting)
CREATE TABLE username_changes (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    old_username VARCHAR(50),
    new_username VARCHAR(50),
    changed_at TIMESTAMP DEFAULT NOW()
);
```

#### **API Endpoints:**
```
POST /api/user/verify-password
- Verify current password for changes
- Rate limit: 3 attempts per 15 minutes

PATCH /api/user/password
- Update password with verification token
- Invalidate other sessions

PATCH /api/user/username
- Update username with verification token
- Check availability and rate limits

GET /api/user/username-availability
- Real-time username availability check

POST /api/user/password-reset
- Initiate password reset flow

POST /api/user/username-recovery
- Send username to contact methods
```

#### **Frontend Components:**
```tsx
// Challenge Modal Component
const ChallengeModal = ({ type, onSuccess, onCancel }) => {
  const [password, setPassword] = useState('');
  const [attempts, setAttempts] = useState(0);
  const [isVerifying, setIsVerifying] = useState(false);

  const handleVerify = async () => {
    setIsVerifying(true);
    try {
      const response = await verifyPassword(password);
      if (response.success) {
        onSuccess(response.token);
      } else {
        setAttempts(prev => prev + 1);
        // Show error
      }
    } catch (error) {
      // Handle error
    } finally {
      setIsVerifying(false);
    }
  };

  return (
    <Modal>
      {/* Challenge UI */}
    </Modal>
  );
};

// Password Update Component
const UpdatePasswordModal = ({ verificationToken, onClose }) => {
  // Password update form
};

// Username Update Component  
const UpdateUsernameModal = ({ verificationToken, onClose }) => {
  // Username update form with availability check
};
```

---

### **7. SECURITY FEATURES**

#### **Rate Limiting:**
- **3 verification attempts** per 15 minutes
- **Account lockout** after 5 failed attempts in 1 hour
- **Username changes** limited to once per 30 days

#### **Session Management:**
- **Password changes** invalidate other sessions
- **Username changes** don't affect current session
- **Verification tokens** expire after 10 minutes

#### **Audit Trail:**
- **Log all attempts** (successful and failed)
- **Track IP addresses** for security monitoring
- **Email notifications** for successful changes

#### **Input Validation:**
- **Password strength** requirements
- **Username format** validation
- **Real-time availability** checking
- **XSS/injection** protection

---

### **8. REPLIT IMPLEMENTATION CHECKLIST**

**Phase 1 - Backend Security:**
- [ ] Create verification endpoints
- [ ] Implement rate limiting
- [ ] Add audit logging
- [ ] Set up session invalidation

**Phase 2 - Challenge System:**
- [ ] Build challenge modal component
- [ ] Add password verification logic
- [ ] Implement help link actions
- [ ] Create error handling

**Phase 3 - Update Forms:**
- [ ] Password update modal
- [ ] Username update with availability
- [ ] Success/error notifications
- [ ] Form validation

**Phase 4 - Integration:**
- [ ] Add to settings panel
- [ ] Connect with existing auth
- [ ] Test security measures
- [ ] Mobile responsiveness

This system provides secure, user-friendly password and username updates while maintaining strong security practices and clear user guidance through the help links.